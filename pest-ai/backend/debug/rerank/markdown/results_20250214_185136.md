# Search Results for: What is RLAMFAC?

Keywords: rlamfac

## Variations
1. What is RLAMFAC?
2. Can you explain what RLAMFAC is?
3. Tell me about RLAMFAC
4. Define RLAMFAC
5. Describe RLAMFAC


## Context

### Summary
**RLAMBDA1 (initial Marquardt lambda, ~10.0) and RLAMFAC (Marquardt lambda adjustment factor, ~2.0 or -3.0) control lambda adjustments during iterations.  PHIRATSUF (objective function reduction ratio, ~0.3) determines iteration completion; if not met, PHIREDLAM is used.**

### Header
**4.2.6 Fifth Line**

### Content
RLAMBDA1
This real variable is the initial Marquardt lambda. As discussed in the previous section, each iteration of the inversion process undertaken by PEST is divided into two parts. The first part comprises calculation of the Jacobian matrix. The second part is devoted to the testing of parameter upgrades that are calculated using different values of the Marquardt lambda. The role of the Marquardt lambda is described in section 5.4.2 of Doherty (2015).
During any one iteration of the inversion process PEST attempts parameter improvement using a number of different Marquardt lambdas. The starting value of the Marquardt lambda during any one iteration is inherited from the previous iteration; it is generally somewhat lower than that which allowed calculation of the lowest objective function during that iteration. Over the course of the entire inversion process the Marquardt lambda should generally fall. However it may rise if an inverse problem is poorly posed.
RLAMBDA1 is the initial value of the Marquardt lambda. This informs PEST of the first value that it should test during the first iteration of the inversion process. A value of 10.0 is appropriate in most cases. However if PEST complains about the normal matrix being singular you may need to raise it. (A better alternative would be to add regularisation to the PEST control file and/or employ singular value decomposition or LSQR as a solution mechanism for the inverse problem.)
RLAMFAC
RLAMFAC, a real variable, is the factor by which PEST adjusts the Marquardt lambda as it tests different values of this variable for their efficacy in lowering the objective function. RLAMFAC must be greater than 1.0; a value of 2.0 seems to work well on many occasions.
When PEST reduces lambda it divides by RLAMFAC; when it increases lambda it multiplies by RLAMFAC. PEST reduces lambda if it can. However if the inverse problem is nonunique and is unsupplemented by regularisation or by use of singular value decomposition or LSQR as a solution device, or if a reduction in lambda does not lower the objective function, PEST has no choice but to increase lambda.
Alternatively, the Marquardt lambda can be given a negative value less than -1.0. Suppose that it is given a value of -3.0. Then PEST will adjust the lambda adjustment factor during each iteration of the inversion process so that lambda can achieve a value of 1.0 with three adjustments (if PEST decides to move it in this direction). This allows rapid adjustment of the Marquardt lambda if this is suddenly required, as can happen if local parameter insensitivity.
promulgates sudden problem ill-posedness.
More specifically, suppose that RLAMFAC is supplied as –r where r is positive. Let λ be the value of the Marquardt lambda at the beginning of a particular iteration, this being inherited from the previous iteration as described above. Then a Marquardt lambda adjustment factor f for use in the current iteration is calculated as follows.
f = min[λ1/r, 2.0] if λ > 1.0 (4.2.1a)
f = min[(1/λ)1/r, 2.0] if λ < 1.0 (4.2.1b)
f = 2.0 if λ = 1.0 (4.2.1c)
If supplying a negative value for RLAMFAC it is important to note that the higher the absolute value assigned to a negative RLAMFAC, the smaller will be the actual iteration-specific Marquardt lambda adjustment factor. This is opposite to the case for a positive setting of RLAMFAC. In both cases however, the absolute value of RLAMFAC must be greater than 1.0.
An RLAMFAC value of -3.0 works well on most occasions.
PHIRATSUF
During any one iteration of the inversion process, PEST may calculate a parameter upgrade vector using a number of different Marquardt lambdas. First it lowers lambda and, if this is unsuccessful in lowering the objective function, it then raises lambda. If, at any stage, it calculates an objective function which is a fraction PHIRATSUF or less of the starting objective function for that iteration, PEST considers that the goal of the current iteration has been achieved and moves on to the next iteration. Thus PEST will commence iteration i+1 if, at any stage during iteration i
Φij/Φi-1 ≤ PHIRATSUF (4.2.2)
where Φi-1 is the lowest objective function calculated for iteration i-1 (and hence the starting value for iteration i) and Φj is the objective function corresponding to a parameter set i calculated using the j’th Marquardt lambda tested during iteration i.
PHIRATSUF (which stands for “phi ratio sufficient”) is a real variable for which a value of 0.3 is mostly appropriate. If it is set too low, model runs may be wasted in search of an objective function reduction which it is not possible to achieve, given the linearity approximation upon which the inversion equations described in Doherty (2015) are based. If it is set too high, PEST may not be given the opportunity of refining lambda in order that its value continues to be optimal as the inversion process progresses.
PHIREDLAM
If a new/old objective function ratio of PHIRATSUF or less is not achieved as the effectiveness of different Marquardt lambdas in lowering the objective function is tested, PEST must use some other criterion in deciding when it should move on to the next iteration. This criterion is partly provided by the real variable PHIREDLAM.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.2 Control Data Section

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** Figure 4.2 shows "control data" section variables (from Appendix A, Figure A1.1).  Some variables are discussed later. The first line must be "* control data";  some variables are optional (in brackets).

### Related Context
- **Previous Summary:** DERZEROLIM (optional) defines a Jacobian matrix zero threshold for compressed storage. NTPLFLE is the number of template files; NINSFLE is the number of instruction files. PRECIS ("single" or "double") sets precision. DPOINT ("point" or "nopoint") controls decimal point inclusion. NUMCOM, JACFILE, MESSFILE (Chapter 12) handle model-calculated derivatives. OBSREREF (Chapter 14) activates observation re-referencing.
- **Next Summary:** PEST iteratively adjusts Marquardt lambda (RLAMBDA1, RLAMFAC) to minimize the objective function.  It stops when the objective function reduction is less than PHIRATSUF or PHIREDLAM (Equation 4.2.3). NUMLAM limits lambda tests per iteration.  JACUPDATE (optional) enables Broyden Jacobian updates. LAMFORGIVE ("lamforgive" or "nolamforgive") handles model run failures.

### Metadata
- **Keywords:** PHIRATSUF, PHIREDLAM, RLAMBDA1, RLAMFAC, lambdas
- **Chunk ID:** 9b975b5255bb
- **Chunk Index:** 1
- **Previous Chunk ID:** e611a7673cad
- **Next Chunk ID:** 2995daaa6e7c

---

## Context

### Summary
**PARLAM (non-zero negative integer) limits agents in parallel lambda testing; -9999 runs one cycle (NUMLAM runs), using a wider range of lambdas (RLAMFAC becomes its negative), and processes all results regardless of trends. This is recommended with many nodes but may increase model failure risk (mitigated by LAMFORGIVE); parameter freezing is also affected.**

### Header
**11.2.6 Alternative PARLAM Settings**

### Content
In response to this imperative, PARLAM can be set to a negative number. As long as it is non-zero, partial parallelisation of the lambda search procedure is activated. However the number of agents involved in this lambda search procedure is limited to the absolute value of PARLAM. Thus, for example, if parallelisation is being undertaken using 50 agents, and if PARLAM is set to -4, then Parallel PEST involves only 4 agents in the partial parallelisation of lambda testing.
A PARLAM setting of -9999 however has special significance. This setting should only be employed where a user has access to a relatively large number of computing nodes of equal power. If PARLAM is set to -9999, the parallel lambda testing procedure follows the strategy set out below.
1. Only one cycle of parallel runs is devoted to testing Marquardt lambdas; PEST will not commit to a second cycle, irrespective of results forthcoming from the first cycle.
2. The maximum number of parallel runs constituting this cycle is set to NUMLAM, the variable in the “control data” section of the PEST control file which sets the
maximum number of lambda-testing runs undertaken per iteration. However if there are less agents than NUMLAM available at the time that lambda testing is required, NUMLAM is temporarily reduced to the number of available agents.
1. If it is not supplied as a negative number, RLAMFAC (the lambda multiplier employed in lambda testing) is set internally to the negative of its supplied value. Hence, as described in section 4.2.6 of this manual, a much wider range of lambda values is tested than would be the case if a value-independent multiplier were employed.
2. Tested lambda values (on different agent machines) are disposed in equal numbers above and below the current value of the Marquardt lambda.
3. The outcomes of all such runs are read, irrespective of “trends” discovered from the processing of early returns. Thus if the dependence of the objective function on the Marquardt lambda is irregular (such as can occur if finite-difference derivatives are compromised as a result of model output granularity), an “accidental” low objective function corresponding to a random lambda will not be missed.
Use of a PARLAM setting of -9999 is recommended where a user has access to a large number of computing nodes, many of which would be standing idle while implementing a partially parallelised lambda testing strategy. The user must remember however, that the number of model runs employed for lambda testing is set by NUMLAM, and not by the number of agents/nodes available. Hence NUMLAM may need to be set higher than normal. Note also that, as stated above, only one round of lambda-testing runs is undertaken.
It is important to note that for all PARLAM settings other than -9999 Parallel PEST will serialize the lambda testing procedure if any parameter hits its bound, even though it may have commenced the lambda testing procedure as a parallelised process. As stated above, this is because it reformulates the inverse problem to accommodate the fact that the parameter is temporarily non-adjustable.
Despite its advantages, caution should be exercised when setting PARLAM to -9999. If a model is susceptible to crashing when it is supplied with parameter values that it finds unpalatable, this is most likely to occur during the lambda testing procedure, for this is the part of the parameter estimation process where parameter values are most different from those that have been employed previously. Testing of a wide range of lambda values in this parallel fashion can increase the chances of model run failure. Note, however, that PEST failure can be prevented through an appropriate setting of the LAMFORGIVE control variable. This can reduce some of the risks associated with setting PARLAM to -9999.
Another negative feature of a -9999 PARLAM setting is that PEST’s ability to sequentially and temporarily freeze parameters that have hit their bounds (and re-formulate the inverse problem accordingly) is compromised to some extent. Nevertheless the methodology for partially parallelised lambda testing supported by a PARLAM value of -9999 can be of great use where, as stated above, model derivatives are compromised because of model numerical imperfections, and/or the number of processors to which Parallel PEST has access is high.
If setting PARLAM to -9999, it is a good idea to set RLAMFAC to a higher negative value than normal (for example a value of -4 rather than the recommended values of -2 or -3) so that it can sample the objective function vs. lambda curve in greater detail (perchance to fall into objective function crevices in a possibly noisy relationship between Marquardt lambda and the objective function).

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 11. Parallel PEST and BEOPEST (continuación)
- **Subsection:** 11.2 Parallel PEST – Concepts and Specifications

### Additional Summaries
- **Higher-Level Summary:** Parallel PEST and BEOPEST parallelize model runs to reduce run time. Parallel PEST needs a run management file, while BEOPEST's is optional. Both distribute runs to available machines, with BEOPEST using faster TCP/IP communication. Parallel PEST uses PAGENT agents, requires separate folders for agents, and shared signal files for communication. BEOPEST offers ease of use, faster communication, flexibility, and support for multiple command lines and surrogate models.
- **Detailed Summary:** Parallel PEST distributes model runs across networked machines, using a PAGENT agent program on each machine. It requires separate folders for agents to avoid file conflicts and uses shared signal files for communication. The run management file lists agents, runtimes, and filenames. Parallel PEST partially parallelizes Marquardt lambda testing, potentially leading to different solution paths.

### Related Context
- **Previous Summary:** Parallel PEST partially parallelizes Marquardt lambda testing.  It runs models with multiple lambdas concurrently; however, runs exceeding 1.8 times the fastest run are excluded.  The "packet" size equals the number of fast agents.  Decision-making occurs after each packet, potentially wasting some runs. The process differs from serial lambda testing, potentially leading to different paths to the solution.  Limiting the number of agents is recommended to prevent problems from widely varying lambdas.
- **Next Summary:** In Parallel PEST, a negative NUMLAM value in the PEST control file automatically sets PARLAM to -9999, overriding the run management file's PARLAM value. The number of parallel model runs then equals the absolute value of NUMLAM.

### Metadata
- **Keywords:** LAMFORGIVE, NUMLAM, RLAMFAC, lambdas
- **Chunk ID:** bdc8c3cc13a0
- **Chunk Index:** 2
- **Previous Chunk ID:** e4b1d5dd3fcb
- **Next Chunk ID:** c666fa5fe8ca

---

## Context

### Summary
**PPAUSE, PUNPAUSE, PSTOP, and PSTOPST (Part II) control PEST execution via pest.stp.  <Ctrl-C> also stops PEST.  User termination is common due to poor fit, unrealistic parameters, or erratic objective function behavior. Ill-posed inverse problems are addressed using regularization, SVD, or LSQR, and RLAMFAC=-3.**

### Header
**4.19.2 Format of a Covariance Matrix File**

### Content
File pest.stp can be written by the user using any text editor while positioned in another window to that in which PEST is running. However this file can also be written using programs PPAUSE, PUNPAUSE, PSTOP and PSTOPST supplied with PEST simply by typing the name of the appropriate program as a command while situated in the PEST working folder in another command line window. As the names suggest, PPAUSE writes a “3” to pest.stp in order to tell PEST to pause execution; PUNPAUSE writes a “0” to pest.stp to tell it to resume execution; PSTOP writes a “1” to tell PEST to cease execution, while PSTOPSTP instructs PEST to cease execution with a full parameter statistics printout by writing a “2” to file pest.stp. Note that if the non-parallel version of PEST is running, PEST will not respond to the presence of file pest.stp until the current model run is complete. In contrast, Parallel PEST and BEOPEST respond immediately; however the various incidences of the model will continue to run to completion in their own windows after PEST execution has ceased.
There is, of course, another way to stop PEST. Simply press &lt;Ctl-C&gt; in the command line window in which PEST is running. If a non-parallel version of PEST is running, these keys may need to be pressed a few times in succession so that execution of both the model and PEST are terminated.
5.4.2 Restarting PEST
See the discussion on the restart switches in section 5.1.5.
5.4.3 Why Stop PEST?
It is rarely necessary for PEST to continue execution until it satisfies the termination criteria set out in the “control data” section of the PEST control file, or other termination criteria that are specific to its use in “predictive analysis”, “regularisation” or “pareto” modes. On most occasions on which PEST is run, you will know yourself when the inversion process is “running out of steam”. Where parameter numbers are high, the cost of continuing the process is also high, as renewed filling of the Jacobian matrix requires many model runs (especially if PEST has switched to use of three or five point finite-difference derivatives).
Reasons for user-termination of PEST execution may include the following:
- It may be apparent from objective functions obtained to date that a good fit between model outcomes and corresponding field measurements will not be achieved. The model may thus require modification before re-embarking on the parameter estimation process.
- The values ascribed to estimated parameters may be unrealistic. This may be construed as a sign that over-fitting is occurring. You may decide that PEST should be run again with measures put in place to prevent this. If running in “regularisation” mode a higher value for the PHIMLIM control variable may be warranted.
The behaviour of the objective function from iteration to iteration may be erratic. This may suggest that finite-difference derivatives are being corrupted by poor model numerical performance. You may like to test this hypothesis using the JACTEST utility before commencing another PEST run with defensive measures put in place.
5.5 If PEST Won’t Work
5.5.1 General
Early versions of PEST often ran into difficulties if the inverse problem which PEST was asked to solve was ill-posed. Ill-posedness makes the JtQJ matrix singular, and hence non-invertible. Sometimes the use of high Marquardt lambda values rendered (JtQJ+λI) invertible and allowed PEST-based inversion to proceed. However this did not alter the fundamentally non-unique nature of the inverse problem. Nor did the Marquardt lambda provide a numerically effective regularisation device. Hence it was up to the user to recognize the nonunique nature of the inverse problem, and to then identify parameters whose insensitivities or high correlation warranted their removal from the parameter estimation process. These were then fixed or tied and the PEST run repeated. Alternatively, manual or automatic user-interventional functionality provided by PEST (see chapter 6) could have been invoked to assist PEST in its handling of problem ill-posedness. However these strategies provided no guarantee that the parameter set achieved through the history-matching process was of minimum error variance.
These days things are different. If the inherent complexity of natural systems is recognized (and indeed embraced, as it must be if parameter and predictive uncertainties are to be quantified), then most inverse problems turn out to be ill-posed. Nevertheless a minimum error variance solution to these problems can often be attained with guaranteed numerical stability by running PEST with the following settings:
- Set RLAMFAC to -3;
- Use singular value decomposition or LSQR to solve the inverse problem;
- Employ Tikhonov regularisation. The ADDREG1 utility is often the easiest way to introduce Tikhonov regularisation to a PEST input dataset.
If PEST does not work with these measures in place, then the reason for its failure must be identified and rectified. A few possible causes of PEST run failure, and their solutions, are now discussed.
5.5.2 Model Output File not Found

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.19 Covariance Matrix Files

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** COVFLE specifies covariance matrix files for observation groups, overriding individual weights. PEST supports various ASCII covariance matrix file formats. Different PEST versions may produce varied results for ill-posed problems. PEST run commands include switches for different functionalities and modes. Parameter estimation results include objective function, estimates, confidence limits, observations, and statistics.

### Related Context
- **Previous Summary:** Model screen output can be redirected to a file (e.g., `modelrun > temp.dat`) or suppressed (`modelrun > nul`). PEST run-time errors halt execution; messages indicate syntax errors or inconsistencies.  Model errors (e.g., incorrect model path) may cause PEST to report an inability to open model output files.  A pest.stp file (1, 2, or 3) controls stopping and pausing PEST execution.
- **Next Summary:** A missing model output file indicates model failure. A zero gradient indicates incorrect model input file names. Erratic objective function behavior suggests poor derivatives (check using JACTEST), potentially caused by insufficient precision, low increments, model numerical issues, or loose solver criteria.  Mitigation strategies include adjusting increments, using DERINCLB, tightening solver criteria, disabling adaptive time-stepping, split slope analysis, five-point stencils, or automatic user intervention.  Nonlinearity can be addressed using parameter change limits (FACPARMAX, RELPARMAX, ABSOLUTE(N)), log transformation, SCALE, or BOUNDSCALE.

### Metadata
- **Keywords:** PHIMLIM, RLAMFAC
- **Chunk ID:** b4b75f923100
- **Chunk Index:** 19
- **Previous Chunk ID:** f4e360bc6498
- **Next Chunk ID:** 53a1defef6a5

---

## Context

### Summary
**PEST iteratively adjusts Marquardt lambda (RLAMBDA1, RLAMFAC) to minimize the objective function.  It stops when the objective function reduction is less than PHIRATSUF or PHIREDLAM (Equation 4.2.3). NUMLAM limits lambda tests per iteration.  JACUPDATE (optional) enables Broyden Jacobian updates. LAMFORGIVE ("lamforgive" or "nolamforgive") handles model run failures.**

### Header
**4.2.6 Fifth Line**

### Content
The first lambda that PEST employs in calculating the parameter upgrade vector during any particular iteration is the lambda inherited from the previous iteration, possibly reduced by a factor of RLAMFAC (unless it is the first iteration, in which case RLAMBDA1 is used). Unless, through the use of this lambda, the objective function is reduced to less than PHIRATSUF of its value at the beginning of the iteration, PEST then tries another lambda,
less by a factor of RLAMFAC than the first. If the objective function is lower than for the first lambda (and still above PHIRATSUF of the starting objective function), PEST reduces lambda yet again; otherwise it increases lambda to a value greater by a factor of RLAMFAC than the first lambda for the iteration. If, in its attempts to find a more effective lambda by lowering and/or raising lambda in this fashion, the objective function begins to rise, PEST accepts the lambda and the corresponding parameter set giving rise to the lowest objective function for that iteration, and moves on to the next iteration. Alternatively if the relative reduction in the objective function between the use of two consecutive lambdas is less than PHIREDLAM, PEST takes this as an indication that it is probably more efficient to begin the next iteration than to continue testing the effect of new Marquardt lambdas. Thus if
(j-1 - j)/j-1 ≤ PHIREDLAMi i i (4.2.3)
where ij is the objective function value calculated during optimisation iteration i using the j’th trial lambda, PEST moves on to iteration i+1.
A suitable value for PHIREDLAM is between 0.01 and 0.05. If it is set too large, the criterion for moving on to the next iteration is too easily met and PEST is not given the opportunity of adjusting lambda to its optimal value for that particular stage of the parameter estimation process. On the other hand if PHIREDLAM is set too low, PEST will test too many Marquardt lambdas on each iteration of the inversion process when it would be better off starting a new iteration. (Note that where model runs are parallelised, the testing of too many Marquardt lambdas may not be so much of an issue as it keeps otherwise idle processors busy.)
NUMLAM
This integer variable places an upper limit on the number of lambdas that PEST will test during any one iteration. It should normally be set between 5 and 10 (normally closer to 10); however if RLAMBDA1 is set to zero (which is not recommended) it must be set to 1.
JACUPDATE
The Broyden Jacobian update procedure is described in section 5.4.2 of Doherty (2015). It provides a mechanism for improving the Jacobian matrix based on model outputs calculated during model runs undertaken for the purpose of testing parameter upgrades calculated using different values of the Marquardt lambda.
If JACUPDATE is omitted from the fifth line of the “control data” section of the PEST control file, or if it is set to zero, Broyden updating of the Jacobian matrix does not occur. However if it is set to n, where n is a positive integer, Broyden updating will be undertaken during the second part of every PEST iteration following the first n attempts to upgrade parameters using n different values of the Marquardt lambdas. Alternatively, it can be set to 999. In this case the Jacobian matrix is updated after the first parameter upgrade attempt, and every parameter upgrade attempt thereafter.
Experience indicates that Broyden Jacobian updating can work well on most occasions, but on some occasions does not. At the time of writing it is difficult to predict when it is likely to work well and when the opposite is likely to occur. The “safest” option is not to activate it as it can, under some circumstances, actually hinder the progress of the inversion process. Still, these occasions appear to be relatively rare, and in the majority of cases it is worth a try.
LAMFORGIVE
Sometimes, when a model is provided with a particular set of parameters, it fails to run to completion. Its output file is not then written. PEST reports this error condition and ceases execution with an appropriate error message. This situation is most likely to arise during those phases of the parameter estimation process where PEST is altering the value of the Marquardt lambda and testing new upgraded parameter values; this is the stage of the inversion process where parameters provided to the model are most different from their predecessors, and hence where model run failure is most likely to occur.
In most deployment contexts, a better course of action for PEST to take is to ignore the failed model run and attempt calculation of further parameter upgrades using other values of the Marquardt lambda. This response to model run failure can be instigated using the LAMFORGIVE variable.
LAMFORGIVE should be placed on the fifth line of the “control data” section of the PEST control file following the JACUPDATE variable if it is present, or the NUMLAM variable if JACUPDATE is absent. (Actually LAMFORGIVE can be placed in front of the JACUPDATE variable if desired.) It must be supplied as “lamforgive” (to activate model run failure forgiveness) or “nolamforgive” (to de-activate model run failure forgiveness). If it is omitted, a default value of “nolamforgive” is used by PEST.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.2 Control Data Section

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** Figure 4.2 shows "control data" section variables (from Appendix A, Figure A1.1).  Some variables are discussed later. The first line must be "* control data";  some variables are optional (in brackets).

### Related Context
- **Previous Summary:** RLAMBDA1 (initial Marquardt lambda, ~10.0) and RLAMFAC (Marquardt lambda adjustment factor, ~2.0 or -3.0) control lambda adjustments during iterations.  PHIRATSUF (objective function reduction ratio, ~0.3) determines iteration completion; if not met, PHIREDLAM is used.
- **Next Summary:** If LAMFORGIVE is "lamforgive", PEST switches to central derivatives or stops if no lambda produces a successful model run.  Failed parameter sets are saved in ###error.par files. DERFORGIVE ("derforgive" or "noderforgive") handles derivative calculation failures; "derforgive" sets derivatives to zero and reports missing files.

### Metadata
- **Keywords:** JACUPDATE, LAMFORGIVE, NUMLAM, PHIRATSUF, PHIREDLAM, RLAMBDA1, RLAMFAC, lambdas
- **Chunk ID:** 2995daaa6e7c
- **Chunk Index:** 2
- **Previous Chunk ID:** 9b975b5255bb
- **Next Chunk ID:** 9173261c3d0a

---

## Context

### Summary
**Variables RLAMBDA1, RLAMFAC, PHIRATSUF, PHIREDLAM, and NUMLAM on line five control Marquardt lambda selection in PEST (not used by PEST++). For PESTCHEK compatibility, set them to 10.0, -2.0, 0.3, 0.01, and 10, respectively.**

### Header
**4.6.6 Fifth Line**

### Content
The fifth line of the “control data” section of a PEST control file contains variables which control the way in which PEST selects a Marquardt lambda. Programs of the PEST++ suite which employ a Marquardt lambda do not read this line because they use their own lambda control variables. For PESTCHEK-friendliness, set RLAMBDA1, RLAMFAC, PHIRATSUF, PHIREDLAM and NUMLAM to 10.0, -2.0, 0.3, 0.01 and 10 respectively.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation: PEST++ a Software Suite for Parameter Estimation, Uncertainty Analysis, Management Optimization and Sensitivity Analysis
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.6 Control Data Section

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** The optional "automatic user intervention" section (section 6.3) governs automatic user intervention, activated by setting DOAUI to "doaui" in the "control data" section.  If omitted, default values are used.

### Related Context
- **Previous Summary:** NTPFLE and NINSFLE (integers >1) specify template and instruction file counts.  PRECIS ("single") and DPOINT ("point") control parameter value formatting (not used by PEST++). NUMCOM (integer, 1 or omitted for single command lines) specifies the number of model command lines.  These variables are used by PEST but not PEST++.
- **Next Summary:** RELPARMAX, FACPARMAX (≥1.0), and FACORIG (often 0.001) in the "control data" section limit parameter changes per iteration in PESTPP-GLM to prevent overshooting and oscillations.  RELPARMAX < 1.0 is allowed only if bounds are not of opposite sign.  Default values of 10.0 are often suitable.

### Metadata
- **Keywords:** NUMLAM, PHIRATSUF, PHIREDLAM, RLAMBDA1, RLAMFAC
- **Chunk ID:** a02a8be1a203
- **Chunk Index:** 1
- **Previous Chunk ID:** 9813ada0b4b7
- **Next Chunk ID:** b8af6e056ac6

---
