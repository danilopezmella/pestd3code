# Search Results for: What is PHIREDSTP?

Keywords: phiredstp

## Variations
1. What is PHIREDSTP?
2. Explain what PHIREDSTP is
3. Describe PHIREDSTP
4. Tell me about PHIREDSTP
5. Define PHIREDSTP


## Context

### Summary
**NOPTMAX (integer) sets maximum iterations; 0 runs one model; -1 or -2 calculates the Jacobian matrix.  PHIREDSTP (real) and NPHISTP (integer) define convergence criteria based on objective function reduction. NPHINORED (integer) sets iterations without improvement before stopping. RELPARSTP (real) and NRELPAR (integer) use maximum relative parameter change for termination.  PHISTOPTHRESH (real, optional) stops if the objective function is below its value. LASTRUN (integer, optional) controls the final model run; PHIABANDON (real, optional) stops if the objective function exceeds its value.**

### Header
**4.2.9 Eighth Line**

### Content
NOPTMAX
NOPTMAX, an integer variable, sets the maximum number of iterations that PEST is allowed to undertake on a particular parameter estimation run. If you wish to ensure that PEST termination is triggered by other criteria, more indicative of convergence to an optimal parameter, you should set this variable to a high value such as 50.
Two settings for NOPTMAX have special significance however. If NOPTMAX is set to 0, PEST will not estimate parameters, nor even calculate a Jacobian matrix. Instead it will terminate execution after just one model run. This setting can be used to ensure that PEST setup is correct; at the same time, it can be used to compute objective function components and residuals based on initial parameter values provided in the PEST control file.
If NOPTMAX is set to -2 PEST will calculate the Jacobian matrix, store it in a JCO file, and then cease execution immediately. This matrix can then be used for linear analysis, and/or for construction of an SVD-assist input dataset.
Setting NOPTMAX to –1 also instructs PEST to compute the Jacobian matrix. However after doing this, PEST records the same information on its output files as that which it would normally record on completion of an inversion process. This includes composite sensitivities and, if pertinent, post-calibration uncertainty and covariance statistics calculated from parameter sensitivities. It then undertakes a final model run so that model input and output files remaining after PEST execution is complete pertain to parameters values provided in the PEST control file.
PHIREDSTP and NPHISTP
PHIREDSTP is a real variable whereas NPHISTP is an integer variable. If, in the course of the parameter estimation process, there have been NPHISTP optimisation iterations for which (Φ - Φmin)/Φ ≤ PHIREDSTP, PEST will consider that the inversion process is at an end.
For many cases 0.005 and 4 are suitable values for PHIREDSTP and NPHISTP respectively. However you must be careful not to set NPHISTP too low if the optimal values for some parameters are near or at their upper or lower bounds (as defined by the parameter variables PARLBND and PARUBND discussed below). In this case it is possible that the magnitude of the parameter upgrade vector may be curtailed over one or a number of iterations to ensure that no parameter value overshoots its bound. The result may be smaller reductions in the objective function than would otherwise occur on these iterations. It would be a shame if these reduced reductions were mistaken for the onset of parameter convergence to the optimal set.
NPHINORED
If PEST has failed to lower the objective function over NPHINORED successive iterations, it will terminate execution. NPHINORED is an integer variable; a value of 3 or 4 is often suitable.
RELPARSTP and NRELPAR
If the magnitude of the maximum relative parameter change between iterations is less than RELPARSTP over NRELPAR successive iterations, PEST will cease execution. The relative parameter change between iterations for any parameter is calculated using equation 4.2.4. PEST evaluates this change for all adjustable parameters at the end of all iterations, and determines the relative parameter change with the highest magnitude. If this maximum relative change is less than RELPARSTP, a counter is advanced by one; if it is greater than RELPARSTP, the counter is zeroed. All adjustable parameters, whether they are relative-limited or factor-limited, are involved in the calculation of the maximum relative parameter change. RELPARSTP is a real variable for which a value of 0.005 is often suitable. NRELPAR is an integer variable; a value of 3 or 4 is normally satisfactory.
PHISTOPTHRESH, LASTRUN and PHIABANDON
If PHISTOPTHRESH (a real variable) is set to a positive number, PEST will cease execution if the objective function falls below this value at the end of any iteration. Note that this criterion is applied to the measurement objective function if PEST is run in “regularisation” mode (see chapter 9). Alternatively, if PHISTOPTHRESH is set to zero or a negative number, then it is ignored. An error condition will occur if PHISTOPTHRESH is set to a positive number while PEST is asked to run in “predictive analysis” or “pareto” modes.
If supplied, the integer LASTRUN variable must follow the PHISTOPTHRESH variable on the eighth line of the “control data” section of the PEST control file; PHISTOPTHRESH must also then be supplied. If LASTRUN is set to zero, then PEST will not undertake a final model run using optimised parameters upon termination of execution. If it is not set to zero it must be set to one (its default value).
The real-valued PHIABANDON variable optionally follows LASTRUN (which must be provided if PHIABANDON is provided). If, at the end of the first model run, and any iteration thereafter, the objective function (or measurement objective function if PEST is run in “regularisation” mode) is greater than PHIABANDON, PEST will terminate execution. Set this to a very high number, or to a non-positive number (or omit it altogether), for it to have no effect.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.2 Control Data Section

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** Figure 4.2 shows "control data" section variables (from Appendix A, Figure A1.1).  Some variables are discussed later. The first line must be "* control data";  some variables are optional (in brackets).

### Related Context
- **Previous Summary:** BOUNDSCALE ("boundscale" or "noboundscale") is an optional variable placed on the seventh line of the "control data" section, after PHIREDSWH, NOPTSWITCH, and SPLITSWH, and before DOAUI and DOSENREUSE. It may improve inversion efficiency but can have the opposite effect; it's often worth trying.
- **Next Summary:** PHISTOPTHRESH, PHIABANDON, and LASTRUN control null space Monte Carlo.  PHIABANDON (high value or file) stops calibration if the objective function is too high; LASTRUN (0 or 1) controls the final model run.  A PHIABANDON schedule file provides iteration-specific thresholds.  If the objective function exceeds the threshold, the parameter adjustment process is abandoned.

### Metadata
- **Keywords:** LASTRUN, NOPTMAX, NPHINORED, NPHISTP, NRELPAR, PARLBND, PARUBND, PHIABANDON, PHIREDSTP, PHISTOPTHRESH, RELPARSTP
- **Chunk ID:** 82db2179fce5
- **Chunk Index:** 1
- **Previous Chunk ID:** c130c86cab84
- **Next Chunk ID:** 421e7b0896aa

---

## Context

### Summary
**NOPTMAX (integer, 50 recommended) sets maximum iterations; 0 runs one model; -1 or -2 generates a JCO file.  PESTPP-GLM uses PHIREDSTP (real, 0.005), NPHISTP (integer, 4), NPHINORED (integer, 4), RELPARSTP (real, 0.005), and NRELPAR (integer, 4) for termination; PESTPP-IES uses all except RELPARSTP and NRELPAR. Other PEST++ programs use only NOPTMAX.**

### Header
**4.6.9 Eighth Line**

### Content
The eighth line of the “control data” section of a PEST control file holds variables which control termination of an inversion process. These are NOPTMAX, PHIREDSTP, NPHISTP, NPHINORED, RELPARSTP and NRELPAR. Suitable (PESTCHEK-friendly) values for these variables are provided in figure 4.2, namely 50, 0.005, 4, 4, 0.005 and 4. PESTPP-GLM uses all of these variables; PESTPP-IES uses all except RELPARSTP and NRELPAR. Other programs of the PEST++ suite use only NOPTMAX.
NOPTMAX, an integer variable, sets the maximum number of iterations that an inversion or optimization process is allowed to run. However, values of 0, -1 and -2 trigger behaviour that is dependent on the PEST++ program that reads the PEST control file.
If NOPTMAX is set to 0, PESTPP-GLM does not estimate parameters. Instead it completes one model run using parameter values supplied in the “parameter data” section of the PEST control file. It computes objective function components based on the result of this single model run. This can be used to ensure that PESTPP-GLM setup is correct, and that weights assigned to observations in the “observation data” section of the PEST control file are suitable.
If NOPTMAX is set to -1 or -2, PESTPP-GLM calculates a Jacobian matrix and stores it in a Jacobian matrix file (i.e., a JCO file). If asked to do so, it also calculates linear statistics based on that Jacobian matrix. It then ceases execution. The same Jacobian matrix is available for more complex linear analysis using pertinent PEST utilities, as well as PyEMU. The Jacobian matrix that is stored in the JCO file can also be put to other uses; see section 3.4.
PHIREDSTP is a real variable whereas NPHISTP is an integer variable. If, in the course of a PESTPP-GLM inversion process, there have been NPHISTP optimization iterations for which (Φ*i* - Φ*min* )/Φ*i* ≤ PHIREDSTP (Φ*i* being the objective function value at the end of the *i*th optimization iteration and Φmin being the lowest objective function achieved to date), PESTPP-GLM considers that the inversion process is at an end. Alternatively, if PESTPP-GLM has failed to lower the objective function over NPHINORED successive iterations, it ceases execution. PESTPP-IES supplies these same termination criteria to ensemble-mean objective functions.
If the magnitude of the maximum relative parameter change is less than RELPARSTP over NRELPAR successive iterations, then PESTPP-GLM ceases execution. The relative parameter change between iterations for any parameter is calculated using equation 3.2. PESTPP-GLM evaluates this change for all adjustable parameters at the end of all iterations, and determines the relative parameter change with the highest magnitude. If this maximum relative change is less than RELPARSTP, a counter is advanced by one; if it is greater than RELPARSTP, the counter is zeroed.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation: PEST++ a Software Suite for Parameter Estimation, Uncertainty Analysis, Management Optimization and Sensitivity Analysis
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.6 Control Data Section

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** The optional "automatic user intervention" section (section 6.3) governs automatic user intervention, activated by setting DOAUI to "doaui" in the "control data" section.  If omitted, default values are used.

### Related Context
- **Previous Summary:** PHIREDSWH (real, often 0.1) in the "control data" section controls switching from forward to central differences in PESTPP-GLM (FORCEN="switch") if the relative objective function reduction between iterations is ≤ PHIREDSWH.  It's ignored if differential evolution is used.  Equation 4.1 shows the condition for switching.
- **Next Summary:** ICOV, ICOR, and IEIG (integers) in the "control data" section are not used by PESTPP-GLM. Set them to 0 for PESTCHEK compatibility.

### Metadata
- **Keywords:** NOPTMAX, NPHINORED, NPHISTP, NRELPAR, PHIREDSTP, RELPARSTP
- **Chunk ID:** cbb14971764f
- **Chunk Index:** 1
- **Previous Chunk ID:** e113dd2e0863
- **Next Chunk ID:** e93b50160cd8

---

## Context

### Summary
**PESTPP-IES uses termination criteria (NOPTMAX, PHIREDSTP, NPHISTP, NPHINORED, RELPARSTP, NRELPAR) applied to the mean objective function across realizations.  NOPTMAX=0/-1/-2 triggers special behavior.  It reports "composite," "measurement," "regularization," and "actual" objective functions (*ies_reg_factor*>0 for regularization and composite terms).  The  *ies_accept_phi_fac* criterion and partial upgrades handle unsuccessful iterations.  A final model run is performed unless stopped via PSTOPST (in parallel mode).**

### Header
**9.2.9 Termination Criteria, Objective Functions, and Upgrade Acceptance **

### Content
Like PEST and PESTPP-GLM, PESTPP-IES reads termination criteria from the eighth line of the “control data” section of a PEST control file.
PESTPP-IES ceases execution after NOPTMAX iterations have elapsed. However, during these NOPTMAX iterations it applies the PHIREDSTP, NPHISTP and NPHINORED termination criteria to the mean objective function calculated using all realizations of the ensemble over successive smoother iterations. If the relative reduction in the mean objective function is less than PHIREDSTP over NPHISTP iterations, or if NPHINORED iterations have elapsed since the last reduction in the mean objective function has occurred, PESTPP-IES ceases execution.
Note that, as described above, PESTPP-IES also ceases execution if, during any particular iteration of the smoother process, it cannot find in successive NPHINORED iterations, a lambda and scale factor that allows it to calculate parameter upgrades for which the objective function is less than *ies_accept_phi_fac()*. If the results of a particular iteration’s solution process do not meet the acceptable phi criteria (the previous iteration’s mean composite phi time *ies_accept_phi_fac*), then a “partial upgrade” is performed, where only realizations that have yield a phi meeting this criteria are updated. After this partial upgrade, the full ensemble phi statistics are recalculated to determine if the lambda value for the next iteration. If after a partial upgrade, the acceptable phi criteria is still not met, PESTPP-IES will return to upgrade calculations with an increased lambda. In this situation, PESTPP-IES will save “rejected” parameter and observation ensembles in case users want to inspect these quantities.
Special values of NOPTMAX can instigate special PESTPP-IES behaviour. If NOPTMAX is set to -1, PESTPP-IES does not upgrade random parameter sets which comprise an ensemble. It simply runs the model once for each parameter set, records model output values, and then ceases execution, thereby effective undertaking unconstrained Monte Carlo analysis. If NOPTMAX is set to zero, execution of PESTPP-IES is even shorter. It evaluates only the parameter values listed in the control file­ – replicating the behaviour of PESTPP-GLM and PEST. If NOPTMAX is supplied as -2, then PESTPP-IES will calculate the mean value of the initial parameter ensemble, evaluate it (by running the model once) and record the results.
PESTPP-IES reports several different objective functions, namely “composite”, “measurement”, “regularization”, and “actual”, depending on the mode of operation. The “measurement” objective function is calculated using the current simulated outputs and the observations values in the pest control combined with realizations of additive measurement noise (described elsewhere in this manual). The measurement objective function is calculated using the weights in the pest control file (unless an *obscov* is supplied, described elsewhere, or unless a user-generated observations plus noise ensemble is supplied, described elsewhere). Note that if the *ies_no_noise* option is activated, the “measurement” and “actual” objective functions are the same and only the “actual” is reported to the screen and record file.
The “regularization” objective function is calculated as parameter value deviations from the initial (stochastic) realized values–this objective function is scaled by the diagonal of the prior parameter covariance matrix. Note the “regularization” objective function is only used and reported if the value of *ies_reg_factor* is supplied with a value greater than 0.0.
The “composite” objective function is simply the combination of the measurement and regularization objective functions. Note the regularization objective function is reported in the phi summary but the contribution to the composite objective function is controlled by *ies_reg_factor,* which is 0.0 by default. Note the composite objective function is used to select lambda-scale factor pairs and to control termination criteria. Similar to the “regularization” objective function, the “composite” objective function is only used and reported if *ies_reg_factor* is greater than 0.0.
The “actual” objective function is calculated using the current simulated outputs and the observation values in the control file (that is, without measurement noise realizations). Through the *ies_no_noise* option, users can make the “measurement” and “actual” objective functions one in the same. This is an important consideration when subjective weighting is used to balance the contribution of several types of observations to the objective function–a process that can result in very small weights, which implies very large measurement noise.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation: PEST++ a Software Suite for Parameter Estimation, Uncertainty Analysis, Management Optimization and Sensitivity Analysis
- **Main Section:** 9. PESTPP-IES
- **Subsection:** 9.2 Using PESTPP-IES

### Additional Summaries
- **Higher-Level Summary:** Tikhonov regularization in PEST enhances stability by reducing error variance and incorporating expert knowledge. Use IREGADJ, SVD, or LSQR with MAXSING and EIGTHRESH settings for stability. PEST stops after NOPTMAX iterations, reaching target objectives, minimal parameter changes, or slow improvement. Regularization mode categorizes observations into "regul" groups, adjusting weights with a regularization weight factor.
- **Detailed Summary:** To use PEST's "regularisation" mode, set PESTMODE to "regularisation" in the control data section. This mode categorizes observations into "regul" groups and others. Regularization weights are adjusted by the regularization weight factor. Key variables in the "regularisation" section include PHIMLIM, PHIMACCEPT, WFINIT, and others. PEST aims to minimize the regularization objective function while iterating until PHIMLIM is reached. Adjusting PHIMACCEPT, FRACPHIM, and other parameters influences optimization.

### Related Context
- **Previous Summary:** PESTPP-IES generates multiple output files (detailed in the next section), controlled by *ies_verbose_level* (default 1).  It saves parameter and observation ensembles in CSV or JCB files (iteration-specific) and, optionally (*save_lambda_ensembles*=true), lambda-testing parameter sets.  These files are used to diagnose numerical instability issues.
- **Next Summary:** PESTPP-IES balances objective function contributions from observation groups internally (*ies_phi_factor_file*,  two-column file: tag, phi factor) at runtime.  Tags identify groups; phi factors set group contributions (maintaining the mean measurement phi).  *ies_phi_factors_by_real*=true enables per-realization weighting (using a table of realization and tag-based phi factors).  pyEMU and PEST utilities offer more granular control.

### Metadata
- **Keywords:** NOPTMAX, NPHINORED, NPHISTP, PHIREDSTP, ies_accept_phi_fac, ies_no_noise, ies_reg_factor
- **Chunk ID:** 3e78a19f3d34
- **Chunk Index:** 1
- **Previous Chunk ID:** 15858d119534
- **Next Chunk ID:** 2fbe597b07b9

---

## Context

### Summary
**In "regularisation" mode, PEST stops if NOPTMAX iterations elapse, the measurement objective function reaches the target (PHIMLIM, REGCONTINUE="nocontinue"), PHISTOPTHRESH is reached, parameter changes are minimal (RELPARSTP, NRELPAR), or objective function improvement is slow (PHIREDSTP, NPHISTP, NPHINORED, REGCONTINUE="continue").  User termination is often preferable, especially during early calibration attempts.**

### Header
**9.1.6 Termination Criteria**

### Content
When running in “regularisation” mode, PEST will cease execution if the following conditions are met.
1. NOPTMAX iterations have elapsed.
2. The measurement objective function falls below the user-supplied target measurement.
Objective function and the REGCONTINUE regularisation variable is missing or set to “nocontinue”.
1. The measurement objective function falls below the value of the optional PHISTOPTHRESH variable supplied in the “control data” section of the PEST control file, regardless of the setting of the REGCONTINUE variable.
2. Parameter changes between iterations are minimal as assessed through reference to the RELPARSTP and NRELPAR variables provided in the “control data” section of the PEST control file.
3. The measurement objective function is greater than PHIMLIM but is falling very slowly as assessed through reference to the PHIREDSTP, NPHISTP and NPHINORED variables provided in the “control data” section of the PEST control file.
4. The measurement objective function is lower than PHIMLIM, REGCONTINUE has been set to “continue” and the regularisation objective function is falling very slowly as assessed through reference to the PHIREDSTP, NPHISTP and NPHINORED variables provided in the “control data” section of the PEST control file.
In practice, it is often best for a user to terminate PEST execution him/herself, especially during an early calibration attempt of a new model where the target measurement objective function may be set very low in an attempt to find out just how good a fit with the calibration dataset PEST can actually achieve.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 9. Tikhonov Regularisation (continuación)
- **Subsection:** 9.1 General (continuación)

### Additional Summaries
- **Higher-Level Summary:** Tikhonov regularization in PEST enhances stability by reducing error variance and incorporating expert knowledge. Use IREGADJ, SVD, or LSQR with MAXSING and EIGTHRESH settings for stability. PEST stops after NOPTMAX iterations, reaching target objectives, minimal parameter changes, or slow improvement. Regularization mode categorizes observations into "regul" groups, adjusting weights with a regularization weight factor.
- **Detailed Summary:** Tikhonov regularization enhances stability by reducing error variance and incorporating expert knowledge. To ensure stability, use IREGADJ, SVD, or LSQR with MAXSING and EIGTHRESH settings. PEST stops after NOPTMAX iterations, reaching target objectives, minimal parameter changes, or slow improvement. User termination is recommended, especially in early calibration.

### Related Context
- **Previous Summary:** Tikhonov regularization minimizes error variance and improves numerical stability by incorporating expert knowledge.  A low target objective function may cause instability; IREGADJ helps but SVD or LSQR (with MAXSING and EIGTHRESH settings or, for many parameters, LSQR) ensures stability.
- **Next Summary:** To use PEST's "regularisation" mode, set the PESTMODE variable in the "control data" section to "regularisation".

### Metadata
- **Keywords:** NOPTMAX, NPHINORED, NPHISTP, NRELPAR, PHIMLIM, PHIREDSTP, PHISTOPTHRESH, REGCONTINUE, RELPARSTP
- **Chunk ID:** 1720c041e020
- **Chunk Index:** 1
- **Previous Chunk ID:** 72454911513c
- **Next Chunk ID:** 213e5751269f

---

## Context

### Summary
**Maximum factor and relative parameter changes are recorded per iteration, aiding in change limit (FACPARMAX, RELPARMAX, ABSPARMAX(N)) assessment.  Parameter "ro2" is frozen at its bound in iteration 2, then released in iteration 3. A switch to central derivatives occurs at iteration 4 (PHIREDSWH).  The run ends at iteration 8 (NPHISTP and PHIREDSTP).  Objective function contributions per group help assess weighting.  Final results include parameter estimates and 95% confidence limits (if no regularization).**

### Header
**4.19.2 Format of a Covariance Matrix File**

### Content
The recording of the maximum factor, relative and (if pertinent) absolute parameter changes at the end of each iteration can also help you to judge whether you have set pertinent change limit variables (i.e. FACPARMAX, RELPARMAX and possibly one or more ABSOLUTE(N) variables) wisely. In the present case only the maximum factor change is needed because no parameters are relative-limited or absolute-limited; the maximum relative parameter change is still recorded, however, because one of PEST’s termination criteria involves the use of relative parameter changes. Note that had some of the parameters featured in figure 5.1 been relative-limited or absolute-limited, this part of the run record would have been slightly different in that the maximum factor parameter change would have been provided only for factor-limited parameters, the maximum relative parameter change would have been provided only for relative-limited parameters and the maximum absolute change would have been provided only for parameters to which an absolute(N) limit applies (for each N). However a further line documenting the maximum relative parameter change for all parameters would have been added because of its pertinence to the aforementioned termination criterion.
The PEST run record of figure 5.1 shows that in iteration 2, one of the parameters, namely “h2”, incurs the maximum allowed factor change, thus limiting the magnitude of the parameter upgrade vector. In iteration 3, parameter “h1” limits the magnitude of the parameter upgrade vector through incurring the maximum allowed parameter factor change. It is probable that convergence for this case would have been achieved much faster if FACPARMAX in the PEST control file were set higher than 3.0 (a default value of 10.0 is recommended).
At the beginning of the second iteration, parameter “ro2” is at its upper bound. After
Calculating the Jacobian matrix and calculating an upgrade vector, PEST notices that parameter “ro2” does not wish to move back into its domain; so it temporarily freezes this parameter at its upper bound and calculates an upgrade vector solely on the basis of the remaining adjustable parameters. PEST notifies the user that movement of parameter “ro2” is thereby temporarily disabled. At the beginning of iteration 3, parameter “ro2” is released again in case, with the upgrading of the other adjustable parameters during the previous iteration, it wants to move back into the internal part of its domain.
In the third iteration only a single Marquardt lambda is tested, the objective function having been lowered to below 0.3 times its starting value for that iteration through the use of this single lambda; 0.3 is the user-supplied value for the PEST control variable PHIRATSUF.
At the end of iteration 4 PEST calculates that the relative reduction in the objective function from that achieved in iteration 3 is less than 0.1; i.e. it is less than the user-supplied value for the PEST control variable PHIREDSWH. Hence, as the input variable FORCEN for at least one parameter group (both groups in the present example) is set to “switch”, PEST records the fact that it will be using central differences to calculate derivatives with respect to the members of these groups from now on. However the use of central derivatives does not result in a significant further lowering of the objective function, nor in a dramatic change in parameter values, the objective function having been reduced nearly as far as possible through the use of forward derivatives only. (In other cases, especially those involving a greater number of adjustable parameters than in the above example, the introduction of central derivatives can often get a stalled inversion process moving again.)
The parameter estimation process recorded in figure 5.1 is terminated at the end of iteration 8, after the lowest 4 (i.e. NPHISTP) objective function values are within a relative distance of 0.005 (i.e. PHIREDSTP) of each other. (As stated elsewhere in this manual, it is not important that PEST be allowed to terminate the inversion process itself. If you feel that the objective function is unlikely to fall much further, you can terminate the inversion process any time that you feel like it. This can save many wasted model runs.)
Note that where PEST lists the current objective function value at the start of the inversion process and at the start of each iteration, it also lists the contribution made to the objective function by each observation group (including the observation group “prgp1” comprised solely of prior information). This is valuable information, for if a user notices that one particular group is either dominating the objective function, or is not “seen” as a result of dominance by another contributor, he/she may wish to adjust observation or prior information weights and start the inversion process again. The PWTADJ1 utility documented in part II of this manual can automate the weights-adjustment procedure.
5.2.4 Optimised Parameter Values and Confidence Intervals
After completing the inversion process, PEST prints the outcomes of this process to the third section of the run record file. First it lists estimated parameter values. It does this in three stages; adjustable parameters, then tied parameters and, finally, any fixed parameters.
If no regularisation is used in the inversion process, PEST then calculates 95 percent confidence limits for estimated parameters. However, you should note carefully the following points about confidence limits.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.19 Covariance Matrix Files

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** COVFLE specifies covariance matrix files for observation groups, overriding individual weights. PEST supports various ASCII covariance matrix file formats. Different PEST versions may produce varied results for ill-posed problems. PEST run commands include switches for different functionalities and modes. Parameter estimation results include objective function, estimates, confidence limits, observations, and statistics.

### Related Context
- **Previous Summary:** The run record file echoes most input data, then shows initial objective function and parameter values. Each iteration lists tested Marquardt lambdas and their objective function values;  it stops when the relative reduction is less than PHIREDLAM.  Updated and previous parameter values, maximum factor and relative changes, and the names of the parameters exhibiting those changes are also recorded.
- **Next Summary:** Parameter confidence limits (95%), calculated assuming linearity, are provided in the run record file unless the inverse problem is ill-posed, SVD/LSQR are used, or Tikhonov regularization is employed.  Confidence limits are not truncated at parameter bounds and do not account for model assumptions.  Tied parameters do not have confidence limits;  the parameter value file (case.par) also lists estimated values.  The run record file also provides: observations and prior information (measured, calculated, residual, weight/covariance matrix, group), objective function, correlation coefficient, residual analysis, and K-L information statistics (AIC, AICC, BIC, KIC—only for "estimation" mode, excluding SVD/LSQR).

### Metadata
- **Keywords:** FACPARMAX, FORCEN, NPHISTP, PHIRATSUF, PHIREDSTP, PHIREDSWH, RELPARMAX
- **Chunk ID:** 9babaf2a4d7c
- **Chunk Index:** 9
- **Previous Chunk ID:** bcbc3375f6d9
- **Next Chunk ID:** 412b07c7a938

---
