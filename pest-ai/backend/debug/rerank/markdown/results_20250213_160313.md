# Search Results for: how many

Keywords: None

## Variations
1. how many?
2. could you specify how many?
3. please state how many
4. indicate how many
5. tell me how many


## Context

### Summary
**For large problems, use 64-bit versions of PEST, Parallel PEST, BEOPEST, and their utilities for faster execution and increased memory capacity.**

### Header
**15.3 Versions of PEST**

### Content
Where problem sizes are large, use 64 bit versions of PEST, Parallel PEST and BEOPEST (and of PEST support utilities for which 64 bit versions are provided). Execution is generally faster. Much more memory can be addressed.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 15. Large Numbers of Parameters
- **Subsection:** 

### Additional Summaries
- **Higher-Level Summary:** This chapter discusses efficient calibration methods for models with tens of thousands of parameters using PEST. Adjoint techniques are recommended for highly parameterized models. Use compressed binary external derivatives files, 64-bit versions of PEST for large problems, and optimize Jacobian matrix storage. Prioritize linearity of regularization constraints and activate memory conservation for improved efficiency.
- **Detailed Summary:** 

### Related Context
- **Previous Summary:** For highly parameterized models (tens of thousands), model-calculated derivatives (adjoint techniques, Chapter 12) are necessary due to the excessive number of model runs and imprecision of finite differences.  Compressed binary external derivatives files are recommended; elements should be ordered by observation then parameter for optimal efficiency.
- **Next Summary:** In highly parameterized inversions, Jacobian matrix storage (dimensions (no+np)×m) can be excessive.  Many sensitivities and Tikhonov regularization elements are often zero. A data storage mechanism that omits zero-valued elements significantly reduces PEST's memory requirements.

### Metadata
- **Keywords:** 
- **Chunk ID:** 99e9db574a30
- **Chunk Index:** 1
- **Previous Chunk ID:** 5d358602f4e2
- **Next Chunk ID:** 8c1f42813f75

---

## Context

### Summary
**CALMAINTAIN compensates for changes (δk₂) in a subset of parameters (k₂) by adjusting another subset (k₁), aiming to maintain calibration (Equation 14.3.3: Z₁δk₁=-Z₂δk₂). It solves exactly if possible; otherwise, it minimizes the right side of Equation 14.3.4.  It uses Equation 14.3.5 (Q<sup>1/2</sup>h=Q<sup>1/2</sup>Zk+Q<sup>1/2</sup>ε) instead of Equation 14.3.1.**

### Header
**14.3.2 Theory**

### Content
Let the action of a (linearized) model Z on its parameters k under calibration conditions be described by the equation
h = Zk + ε (14.3.1)
where ε is a vector of measurement noise. If the parameter set k is partitioned into two sets of parameters k1 and k2, and if measurement noise is neglected, this equation becomes
h = Z1 Z2 k2 k1 = Z1k1 + Z2k2 (14.3.2)
If parameters k2 are altered by δk2, the model will remain in a calibrated state if a set of alterations δk1 to k1 can be found such that
Z1δk1 = -Z2δk2 (14.3.3)
This can only occur if
Z1 Z2 δk2 δk1 = 0 (14.3.4)
That is, if the matrix Z has a null space. If it does not have a null space, or if equation 14.3.3 cannot be solved because one or a number of elements of δk2 lies entirely within the solution space, then δk1 should be chosen such that the right side of equation 14.3.4 is minimized. If this is done, then the model maintains respect for the calibration dataset as much as possible following user‑alterations to k.
CALMAINTAIN solves equation 14.3.3 in the exact sense if it can, and in the least squares sense if it cannot. Thus it finds a δk1 to compensate for a user‑imposed δk2.
Note that the starting equation for CALMAINTAIN’s calculations is actually not equation 14.3.1 at all; instead it uses the following equation, where Q is the weight matrix.
Q1/2h = Q1/2Zk + Q1/2ε (14.3.5)

### Source
- **File Name:** PEST Model-Independent Parameter Estimation User Manual Part II: PEST Utility Support Software
- **Main Section:** 14. Miscellaneous Utilities
- **Subsection:** 14.3 CALMAINTAIN

### Additional Summaries
- **Higher-Level Summary:** Observation re-referencing simplifies derivative calculations by adjusting initial model conditions based on upgraded parameters, improving solver convergence time. It involves creating reference model outputs for accurate derivatives, with specific commands and activation steps. SVDAPREP and BEOPEST support this feature, enhancing model accuracy and efficiency.
- **Detailed Summary:** Observation re-referencing with NUMCOM=1, DERCOM=1 involves three commands: main model command for objective function calculations and parameter upgrades, "d_" command for derivatives, and "r_" command for reference model outputs. For NUMCOM > 1, additional "r_" commands are needed before derivative calculations, except for the first command (index 1). Users create these "r_" commands.

### Related Context
- **Previous Summary:** CALMAINTAIN adjusts parameters to maintain model calibration after altering other parameter values.  It uses linear theory; success depends on model linearity, degree of de-calibration, and null space dimensionality.  It requires a PEST control file with calibrated parameters and a corresponding JCO file.
- **Next Summary:** CALMAINTAIN adjusts parameters to maintain calibration after changes (specified in a parameter adjustment file, Figure 14.2) to other parameters. It prompts for a PEST control file (with JCO file), parameter adjustment file, output parameter value file, solution method ("l" or "s"), number of singular values, and upgrade vector fraction (0.0-1.0).  It uses linear theory (Equation 14.3.3).  Use PARREP and set NOPTMAX=0 to test calibration.

### Metadata
- **Keywords:** 
- **Chunk ID:** 91cc4af72d4e
- **Chunk Index:** 1
- **Previous Chunk ID:** ce978b182871
- **Next Chunk ID:** 1fd4a5136d77

---

## Context

### Summary
**The "prior information" section contains prior information equations (≤300 characters, use "&" for continuation). Each equation starts with PILBL (≤20 characters, unique), followed by linear combinations of PIFAC*PARNME (or PIFAC*log(PARNME)), =PIVAL, WEIGHT, OBGNME.  Parameters must be adjustable; log-transformed parameters require log-based prior information.  ADDREG1 (Part II) automates prior information addition.**

### Header
**4.15 Prior Information Section**

### Content
If the value of NPRIOR provided in the “control data” section of the PEST control file is not zero, PEST expects NPRIOR articles of prior information. Prior information can be thought of as observations which pertain directly to parameters themselves. As such, they comprise part of the calibration dataset which, together with observations, assists in the estimation of parameters. An “observation” which comprises a prior information equation can involve more than one parameter. However relationships between parameters that are encapsulated in prior information equations must be linear. If parameter-constraining “observations” pertain to nonlinear relationships between parameters, these relationships must be calculated by the model itself. The PAR2PAR utility can accomplish this task; see part II of this manual.
The manner in which prior information equations are recorded in the “prior information” section of the PEST control file is not unlike that in which you would write an equation on paper yourself; however certain strict protocols must be observed. Refer to figure 4.1 for an instance of a PEST control file containing prior information. (Note that PEST utilities such as the ADDREG1 utility described in part II of this manual, as well as some of the programs comprising the Groundwater Utility suite, add prior information to a PEST control file automatically, this saving you the trouble of having to add it yourself.)
Each item on a prior information line must be separated from its neighbouring items by at least one space. Each new article of prior information must begin on a new line. No prior information line is permitted to exceed 300 characters in length; however a continuation character (“&” followed by a space at the start of a line) allows you to write a lengthy prior information equation over several successive lines.
Prior information lines must adhere to the syntax set out in figure 4.14.
PILBL PIFAC * PARNME + PIFAC * log(PARNME) ... = PIVAL WEIGHT OBGNME
(one such line for each of the NPRIOR articles of prior information)
Figure 4.14. The syntax of a prior information line.
Each prior information article must begin with a prior information label; this is the character variable PILBL in figure 4.14. Like observation names, this label must be no more than twenty characters in length, is case insensitive, and must be unique to each prior information article.
Following the prior information label is the prior information equation. To the left of the “=” sign there are one or more combinations of a factor (PIFAC) plus parameter name (PARNME), with a “log” prefix to the parameter name if appropriate. PIFAC and PARNME are separated by a “*” character (which must be separated from PIFAC and PARNME by at least one space) signifying multiplication. All parameters referenced in a prior information equation must be adjustable parameters; i.e. you must not include any fixed or tied parameters in an article of prior information. Furthermore, any particular parameter can be referenced only once in any one prior information equation; however, it can be referenced in more than one equation.
The parameter factor must never be omitted. Suppose, for example, that a prior information equation consists of only a single term, namely that an untransformed, adjustable parameter named “par1” has a preferred value of 2.305, and that you would like PEST to include this.
information in the inversion process with a weight of 1.0. If this article of prior information is given the label “pi1”, the pertinent prior information line can be written as
pi1 1.0 * par1 = 2.305 1.0 pr_info
If you had simply written
pi1 par1 = 2.305 1.0 pr_info
PEST would have objected, complaining of a syntax error.
If a parameter is log-transformed, you must provide prior information pertinent to the log of that parameter, rather than to the parameter itself. Furthermore, the parameter name must be placed in brackets and preceded by “log” (note that there is no space between “log” and the following opening bracket). Thus, in the above example, if parameter “par1” is log-transformed, the prior information article should be rewritten as
pi1 1.0 * log(par1) = .362671 1.0 pr_info
Note that logs are taken to base 10. Though not illustrated, you will also need to review the weight which you attach to this prior information equation by comparing the extent to which you would permit the log of “par1” to deviate from 0.362671 with the extent to which model-generated observations are permitted to deviate from their measured counterparts.
The left side of a prior information equation can be comprised of the sum and/or difference of a number of factor-parameter pairs of the type already illustrated; these pairs must be separated from each other by a “+” or “-” sign, with a space to either side of the sign. For example
pi2 1.0 * par2 + 3.43435 * par4 - 2.389834 * par3 = 1.09e3 3.00 group_pr
Prior information equations which include log-transformed parameters must express a relationship between the logs of those parameters. For example if you would like the ratio between the estimated values of parameters “par1” and “par2” to be about 40.0, the prior information equation may be written as
pi3 1.0 * log(par1) - 1.0 * log(par2) = 1.60206 2.0 group_pr

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 4. The PEST Control File
- **Subsection:** 

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** 

### Related Context
- **Previous Summary:** The "model input/output" section (Figure 4.13) links template files (TEMPFLE) to model input files (INFLE) and instruction files (INSFLE) to model output files (OUTFLE). One line per file pair is required;  pathnames are needed for files not in the current directory.  A single template file can be linked to multiple input files; a single output file can be linked to multiple instruction files, but observations are unique.
- **Next Summary:** Each prior information line includes PILBL, a prior information equation (PIFAC*PARNME or PIFAC*log(PARNME)), PIVAL (real), WEIGHT (real, ≥0), and OBGNME (≤12 characters).  Equations must be unique.  Use "&" for line continuation between items.  Covariance matrices (section 3.7) can replace weights in the objective function calculation.

### Metadata
- **Keywords:** NPRIOR, OBGNME, PARNME, PIFAC, PILBL, PIVAL
- **Chunk ID:** f269beb59daa
- **Chunk Index:** 1
- **Previous Chunk ID:** b4b3bdc2cac3
- **Next Chunk ID:** f8d1a69b5ed5

---

## Context

### Summary
**This chapter details methods for efficiently calibrating models with tens of thousands of parameters using PEST;  these methods are necessary for optimal performance.**

### Header
**15.1 Introduction**

### Content
This chapter discusses a number of devices that are offered by PEST for calibration of models that employ tens of thousands of parameters. PEST can performed well in these settings, but will not do so unless at least some of the measures outlined herein are adopted.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 15. Large Numbers of Parameters
- **Subsection:** 

### Additional Summaries
- **Higher-Level Summary:** This chapter discusses efficient calibration methods for models with tens of thousands of parameters using PEST. Adjoint techniques are recommended for highly parameterized models. Use compressed binary external derivatives files, 64-bit versions of PEST for large problems, and optimize Jacobian matrix storage. Prioritize linearity of regularization constraints and activate memory conservation for improved efficiency.
- **Detailed Summary:** 

### Related Context
- **Previous Summary:** Normal restart functionality and the `/i` and `/p1` switches work with observation re-referencing, except that the `/p1` switch is not allowed with BEOPEST when model run partitioning is activated because of management complexity.
- **Next Summary:** For highly parameterized models (tens of thousands), model-calculated derivatives (adjoint techniques, Chapter 12) are necessary due to the excessive number of model runs and imprecision of finite differences.  Compressed binary external derivatives files are recommended; elements should be ordered by observation then parameter for optimal efficiency.

### Metadata
- **Keywords:** 
- **Chunk ID:** b40a94d10b5e
- **Chunk Index:** 1
- **Previous Chunk ID:** 516682e612d8
- **Next Chunk ID:** 5d358602f4e2

---

## Context

### Summary
**Use as many super parameters as computational resources allow; SUPCALC (Part II) estimates optimal solution space dimensions.  More super parameters mitigate linearity assumption violations.  Ill-posed super parameter problems are addressed by Tikhonov regularization, SVD, or LSQR.  Super parameters offer a good compromise for computationally intensive inversions.**

### Header
**10.1.3 How Many Super Parameters?**

### Content
How many super parameters should you employ? Use as many as computing resources permit.
The SUPCALC utility described in part II of this manual attempts to calculate the optimal dimensions of the solution space for a particular inverse problem. It has the information that it needs to do this once a Jacobian matrix has been calculated using base parameters. However, there is no need to limit the number of super parameters that you include in an SVD-assist PEST control file to the SUPCALC-calculated dimensions of the solution space.
As is discussed below, definition of super parameters is based on a linearity assumption that is probably violated to a greater or lesser degree by most models. The dimensionality and composition of solution and null spaces may change as parameter values change. The more super parameters that are estimated, the less this matters. In the end, the only consideration on the number of super parameters to use is the computing resources at your disposal. In fact, if you have enough computing resources to conduct normal inversion, then there is no need to use SVD-assist as a numerical device for solution of the inverse problem at all.
By definition, if the number of super parameters exceeds the dimensions of the solution space, then the super parameter estimation problem is ill-posed. Normally this does not matter. Tikhonov regularisation, if employed, guides the inverse problem towards a minimum error variance solution. Furthermore, if singular value decomposition or LSQR is designated as the solution mechanism in the base parameter PEST control file, then the SVDAPREP utility (see below) designates this as the solution mechanism in the super parameter PEST control file. Numerical stability of the SVD-assisted inversion process is therefore guaranteed, regardless of the number of super parameters which are featured in this problem.
Sometimes available computing resources may be insufficient for use of even the minimum number of super parameters that SUPCALC suggests. Then use whatever number of super parameters that you can. As is explained by Doherty (2015), the parameter simplification implied in definition of super parameters is optimal in the sense that it provides maximum receptivity to the information content of the calibration dataset using the fewest number of “parameter receptacles” for that information. In the end, environmental modelling, and environmental model calibration, is a matter of compromise. Super parameters comprise a very good compromise.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 10. SVD-Assist
- **Subsection:** 10.1 Concepts

### Additional Summaries
- **Higher-Level Summary:** SVD-assist optimizes inversions by estimating "super parameters" instead of native parameters, reducing computational cost. Use standard procedures, PEST, and SVDAPREP for optimal results. Create a base PEST control file, run PEST to generate a Jacobian matrix, and use PARCALC and PICALC for parameter translation and prior information calculation.
- **Detailed Summary:** SVD-assist optimizes highly parameterized inversions by estimating "super parameters" instead of native parameters, reducing computational cost and model runs. Tikhonov regularization can be applied, and results are obtained in case-svda.par and case.bpa files. Use standard procedures, PEST, and SVDAPREP for optimal results.

### Related Context
- **Previous Summary:** SVD-assisted inversion uses the same termination criteria as standard PEST.  A final model run is not automatically performed; use PARREP to create a new control file (case-soln.pst) with optimized parameters, set NOPTMAX to 0, and rerun PEST.  SUBREG1 removes regularization; PWTADJ2 adjusts weights before linear uncertainty analysis.
- **Next Summary:** SVD-assist's strength is reduced model runs; its weakness is reliance on a linearity assumption.  To mitigate nonlinearity, use more super parameters or recompute them after several iterations (using PARREP and SVDAPREP).  Wide base parameter bounds are recommended to avoid limiting super parameter adjustments.  Initial runs with tied parameters can provide a head start.

### Metadata
- **Keywords:** 
- **Chunk ID:** 6bf7b379e076
- **Chunk Index:** 1
- **Previous Chunk ID:** 4ff89dd98b8c
- **Next Chunk ID:** e33f7523ea84

---
